!function(){function e(e){var t=Array.prototype.slice.call(arguments,1);return this.each(function(){if($(this).data("addressIntegration"))if("object"==typeof e)$.error("jQuery.addressIntegration already initialized");else{var r=$(this).data("addressIntegration");r[e]?r[e].apply(r,t):$.error("Method "+e+" does not exist on jQuery.addressIntegration")}else{var r=new s(this,e);$(this).data("addressIntegration",r),r.init()}})}var t,r=0,s=function(s,n){var i=this;i.guid=r,i.settings=$.extend({},e.defaults,n),i.$element=$(s),i.eventPrefix=".addressIntegration"+i.guid,i.events=o(i.settings.events,i.eventPrefix),i.errors=null,i.lastValue="",i.querries=0,i.querriesTmp=0,t||(t=new google.maps.Geocoder),i.geocoder=t,i.debounce=$.debounce(i.settings.debounceEventsTime,function(){0!==i.querriesTmp&&i.checkAddress()})},o=function(e,t){var r=new Array;r=e.split(" ");for(var s="",o=0;o<r.length;o++)s+=r[o]+t+" ";return s},n=function(e,t,r){for(var s,o=e[0].address_components,n=0;n<o.length;++n){var a=o[n].types;i(a,t)&&(s=o[n][r])}return s},i=function(e,t){for(var r=0;r<e.length;++r)if(e[r]==t)return!0;return!1},a={GOOGLE_MAPS_ERROR:"Google maps error.",OVER_QUERY_LIMIT:"Too many queries! Please wait a moment and try again.",REQUEST_DENIED:"Your request was denied",INVALID_REQUEST:"Your query is missing",UNKNOWN_ERROR:"Propably server error, please try again.",UNKNOWN_ERROR_2:"Unknown error.",ERROR:"Google maps unknown error."};s.prototype={init:function(){var e=this,t=this.$element;t.val()&&e.checkAddress(),t.on(e.events,function(){(t.val()!==e.lastValue||e.errors in a)&&(e.querries++,e.querriesTmp++,e.settings.callbackEventFired.apply(e),e.debounce())})},checkAddress:function(){var e=this;this.$element;e.checkAddressCustom(e.settings.callbackSuccess,e.settings.callbackError,e.settings.callbackInProgress)},checkAddressCustom:function(e,t,r){var s=this,o=this.$element;s.querries=s.querries-s.querriesTmp+1,s.querriesTmp=0;var n=s.querries;s.lastValue=o.val();var i=o.val(),a={address:i};a.componentRestrictions={},s.settings.zipcodeMode&&(a.componentRestrictions.postalCode=i),s.settings.regionInfluence&&(a.region=s.settings.regionInfluence),s.settings.regionRestriction&&(a.componentRestrictions.country=s.settings.regionRestriction),s.showLoader(),r&&r.apply(s),s.geocoder.geocode(a,function(r,o){o==google.maps.GeocoderStatus.OK?s.geocoder.geocode({latLng:r[0].geometry.location},function(r,o){o==google.maps.GeocoderStatus.OK?r[1]?s.queue(n,function(){s.checkAddressSuccess(r,e)}):s.queue(n,function(){s.checkAddressFail("NO_RESULTS",t)}):s.queue(n,function(){s.checkAddressFail(o,t)})}):s.queue(n,function(){s.checkAddressFail(o,t)})})},queue:function(e,t){var r=this;e===r.querries&&t()},checkAddressSuccess:function(e,t){var r=this;this.$element;null!==r.errors&&(r.errors=null,r.hideErrors()),r.hideLoader(),r.setFields(e),t&&t.call(r,e)},checkAddressFail:function(e,t){var r=this;this.$element;r.errors=e,r.hideLoader(),r.showErrors(),t&&t.call(r,e)},setFields:function(e){var t=this;t.settings.countrySelector&&$(t.settings.countrySelector).val(n(e,"country","long_name")),t.settings.countryShortSelector&&$(t.settings.countryShortSelector).val(n(e,"country","short_name")),t.settings.citySelector&&$(t.settings.citySelector).val(n(e,"locality","long_name")),t.settings.stateSelector&&$(t.settings.stateSelector).val(n(e,"administrative_area_level_1","long_name")),t.settings.stateShortSelector&&$(t.settings.stateShortSelector).val(n(e,"administrative_area_level_1","short_name")),t.settings.postalCodeSelector&&$(t.settings.postalCodeSelector).val(n(e,"postal_code","long_name")),t.settings.routeSelector&&$(t.settings.routeSelector).val(n(e,"route","long_name")),t.settings.streetNumberSelector&&$(t.settings.streetNumberSelector).val(n(e,"street_number","long_name"))},showErrors:function(){var e=this;"ZERO_RESULTS"===e.errors||"NO_RESULTS"===e.errors?$(e.settings.messageSelector).text(e.settings.customErrorMessage).show():e.errors in a?$(e.settings.messageSelector).text(a[e.errors]).show():$(e.settings.messageSelector).text(e.errors).show()},hideErrors:function(){var e=this;$(e.settings.messageSelector).hide().empty()},showLoader:function(){var e=this;$(e.settings.loaderSelector).show()},hideLoader:function(){var e=this;$(e.settings.loaderSelector).hide()},unbindEvents:function(){var e=this;e.$element.off(e.eventPrefix)},destroy:function(){var e=this;e.unbindEvents(),e.$element.data("addressIntegration",null)}},e.defaults={zipcodeMode:!1,regionInfluence:!1,regionRestriction:!1,events:"propertychange change click keyup input paste",debounceEventsTime:250,customErrorMessage:"No results for given data, the given place propably does not exist.",countrySelector:"#country",countryShortSelector:"#country-short",citySelector:"#city",stateSelector:"#state",stateShortSelector:"#state-short",postalCodeSelector:"#postal-code",routeSelector:"#route",streetNumberSelector:"#street-number",loaderSelector:"#address-integration-loader",messageSelector:"#address-integration-messages",callbackEventFired:function(){},callbackInProgress:function(){},callbackSuccess:function(e){},callbackError:function(e){}},$.fn.addressIntegration=e}();